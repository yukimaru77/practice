# ルベーグ積分入門

## 普通の積分(リーマン積分)

我々が普段使っている積分は __リーマン積分__ と呼ばれている。詳細は[こちら](https://www1.econ.hit-u.ac.jp/kawahira/courses/lebesgue.pdf)で見てほしいが、簡単にいうと、リーマン積分とはリーマン和の極限として定義される。

リーマン和$\sum(f,Δ,Δ^\ast)$は関数$f:[a,b]→R$と区間$[a,b]$の分割$Δ=\lbrace x_1,x_2,\cdots,x_n\rbrace$と分割$Δ$の代表値$Δ^\ast=\lbrace x_1^\ast,x_2^\ast,\cdots,x_n^\ast\rbrace$を用いて

$$
\sum(f,Δ,Δ^\ast):=\sum_{k=1}^nf(x_k^\ast)(x_k-x_{k-1})
$$

と定義される。さらに$|Δ|:=max(x_k-x_{k-1})$とするとこれの極限を用いてリーマン積分は __リーマン和の上限と下限が同じ値に収束するならば__ 収束値Aを用いて

$$
\int_a^bf(x)dx:=A=\lim_{|Δ|→0}\sum(f,Δ,Δ^\ast)
$$

と定義される。重要なのは __リーマン和の上限と下限が同じ値に収束するならば__ という点である。つまりどのような代表値に依存せず収束することが条件である。この性質より例えば有理数なら1、無理数なら0といった関数(ディレクレ関数という)は代表の幅を限りなく0に近づけても代表値を有理数にするのか無理数にするのかで上限と下限が一致しないため積分不可能。

## ルベーグ積分の概説

リーマン和ならぬルベーグ和は関数$f:[a,b]→R$と区間$[a,b]$の値域の分割$Δ=\lbrace y_1,y_2,\cdots,y_n\rbrace$に対し集合$A_K(K=1,2,\cdots ,m)$を
$$
A_K:=\lbrace x\in [a,b]|f(x)\in [y_{k-1},y_k)\rbrace
$$

とし、集合の長さ$μ(A_K)$を適切に定義できればルベーグ和を
$$
\sum_{K=1}^ny_k\cdot μ(A_k)
$$
とすればリーマン和の近似を与えるだろう。これがルベーグ積分の気持ちである。

## ルベーグ外測度

ルベーグ積分はリーマン積分の拡張として定義したいのだから、
1. 閉区間[a,b]の長さμ([a,b])=b-a
2. 互いに素な集合の列$A_n$に対し、$μ(\bigcup_n A_n)=\sum_nμ(A_n)$
3. 集合Aと数xに対し$A+x:=\lbrace a+x|a\in A\rbrace$に対し、$μ(A+x)=μ(A)$

を満たしてほしいのは自然だろう。互いに素な集合の列としたが、例えば$A_3$以降は$\varnothing$とすれば$μ(A_1\cup A_2)=μ(A_1)+μ(A_2)$となる。

ここで任意の冪集合の要素$A\in \mathfrak{P}(R^n)$に対し、ルベーグ外測度$μ^\ast(A)$を以下のように定義する。ただし、まだこの段階では条件2は満たさない。

$$
μ^\ast:\mathfrak{P}(R^n)→R,\quad μ^\ast(A):=inf(\sum_{n=1}^∞|I_n|)
$$
ただし$I_n$はそれぞれ直方体$I_n:=\prod_{i=1}^n(a_i,b_i]$であり、その体積$|I_n|$は$|I_n|:=\prod_{i=1}^n(b_i-a_i)$でありさらに$I_n$からなる集合はAを被膜している。

## ルベーグ外測度の性質

ルベーグ外測度は以下の性質を満たす。

1. Aが空集合$\varnothing$や1点集合、1点集合の可算個の和集合なら$μ^\ast(A)=0$。この時、Aを __零集合__ という。ただし非可算個の和には成り立たないので注意。
2. $A\subset B$ならば、$μ^\ast(A)\leqq μ^\ast(B)$
3. 可算劣加法性(σ-劣加法性)を満たす。R の部分集合からなる列$A_n$に対し、$μ^\ast(\bigcup_n A_n)\leqq\sum_nμ^\ast(A_n)$
4. 区間 [a, b]，[a, b)，(a, b]，(a, b) の外測度はすべて b − a

ここで性質3について、列の話つまり __可算個__ についての話であって有限個の話や非可算個の話はしていないので注意。

5. 性質3において$A_n=\varnothing(3\leqq N )$とすれば任意の$A_1,A_2$に対し$μ^\ast(A_1\cup A_2)\leqqμ^\ast(A_1)+μ^\ast(A_2)$

ここで性質5について、等号成立条件は$A_1\cap A_2=\varnothing$ではないので注意。要は$A_1\cap A_2=\varnothing$でも$μ^\ast(A_1\cup A_2)<μ^\ast(A_1)+μ^\ast(A_2)$  __となる場合が存在する。__ ただし、やはりそれでは性質がよろしくないので互いに素の時、性質3及び性質5で等号をなりたたせる事が目標となる。つまりルベーグ外測度の項で述べた2つめの条件のことである。

## 可測集合

$A_1\cap A_2=\varnothing$の時、$μ^\ast(A_1\cup A_2)=μ^\ast(A_1)+μ^\ast(A_2)$を成り立たせるために、 __可測集合__ を考える。

集合$E\subset R^n$が __可測集合__ であるとは、任意の$F\subset R^n$に対し
$$
μ^\ast(F\cap E)+μ^\ast(F\cap E^c) =μ^\ast(F)
$$
を満たすことを言う。 __可測集合全体からなる集合__ を$\mathfrak{M}$と今後表す。

例えば、$A_1=F\cap E,A_2=F\cap E^c$とすれば$A_1\cap A_2=\varnothing$かつ、$μ^\ast(A_1\cup A_2)=μ^\ast(A_1)+μ^\ast(A_2)$になるし、

新たに可測集合$A'$を用いて$A'_1:=A_1,A'_2:=A_2\cap A',A'_3:=A_2\cap(A')^c,$と置けば$μ^\ast(A_1'\cup A_2'\cap A_3')=μ^\ast(A_1)+μ^\ast(A_2)+μ^\ast(A_3')$となる。

## ルベーグ可測集合の性質

ルベーグ可測集合及び$\mathfrak{M}$の基本性質として以下が成り立つ。

* $A\in \mathfrak{M}$ならば$A^c\in \mathfrak{M}$
* 空集合$\varnothing$は$\varnothing\in\mathfrak{M}$
* ルベーグ集合列を$\lbrace E_j\rbrace ^∞_{j=1}$とすると、$\bigcup_{j=1}^∞E_j$もルベーグ可測集合である。(つまりルベーグ可測集合の可算無限和集合もルベーグ可測集合)

また、以下の可算加法性が成り立つ。

$A_1,A_2,\cdots\in\mathfrak{M}$は互いに素であるとする。この時、任意の$B\in \mathfrak{P}(R^n)$に対し、
$$
μ^\ast(B\cap \bigcup_{i=1}^∞A_i)=\sum_{i=1}^∞μ^\ast(B\cap A_i)
$$
が成り立つ。特に$B=R^n$とすれば
$$
μ^\ast(\bigcup_{i=1}^∞A_i)=\sum_{i=1}^∞μ^\ast(A_i)
$$

が成り立つ。また、空集合はルベーグ可測集合なのでi=n以降を空集合とすれば有限加法性も成り立つのは明らかだろう。

## ルベーグ測度

ルベーグ外測度の始域を$\mathfrak{M}$にした写像$μ$を __ルベーグ測度__ という。
$$
μ:\mathfrak{M}→R,\quad μ(A)=μ^\ast(A)
$$

## σ-集合体、可測空間

集合XとXの部分集合の族$\mathfrak{M}$が以下の性質を満たすとき、$\mathfrak{M}$を __σ-集合体__ 、 __σ-代数__ 、 __σ-加法族__ などという。また$(X,\mathfrak{M})$を __可測空間__ と呼ぶ。

1. $\varnothing\in\mathfrak{M}$
2. $A\in\mathfrak{M}$ならば$A^c\in\mathfrak{M}$
3. $A_1,A_2,\cdots \in\mathfrak{M}$ならば、$\bigcup_{j=1}^∞A_j\in \mathfrak{M}$

また、条件2,3より$A_1,A_2,\cdots \in\mathfrak{M}$ならば、$\bigcap_{j=1}^∞A_j\in \mathfrak{M}$も示される。

ここで条件3の∞をnに変えたもの条件3'とすると、条件1、2、3'を満たす$\mathfrak{M}$を有限加法族と呼ぶ。条件1と条件3より明らかにσ-集合体は有限加法族である。

## σ-加法族の生成

集合XとXの部分集合の族を$F$とする。Fを含むようなσ-加法族全体の集合を$\mathfrak{F}$とすると$F_0=\bigcap_{f\in \mathfrak{F}}f$とすればこれは最小のσ-加法族となる。これを$σ(F)$と書き、Fによって生成されるσ-加法族という。

## ボレル集合、ボレル集合族

$(X,\mathfrak{O})$を位相空間とする。$\mathfrak{O}$で生成されるσ-加法族をボレル集合族といい、$B(X)=σ(\mathfrak{O})$と書く。$B(X)$の元をボレル集合という。

例えば以下はすべてボレル集合B(R)である。
1. (a,b)
2. [a,b]
3. [a,b)
4. {a}
5. Q
6. R\Q

など。証明は[こちら](https://mathlandscape.com/borel-set/)。

また、$B(R)\subset \mathfrak{M}$であり、$(R,B(R))$は可測空間である。一応B(R)に含まれないが$\mathfrak{M}$には含まれる病的な可測集合Xもあるが、基本的に可測集合かどうかはボレル集合に含まれるかどうかを見ればいい。

## ルベーグ測度の単調性

可測集合列$A_n$に対し、次の定理が成り立つ。

1. $A_n\subset A_{n+1}$ならば
$$
μ(\bigcup _{n=1}^∞A_n)=\lim_{n→∞}μ(A_n)
$$
2. $A_{n+1}\subset A_{n}$かつ$μ(A_1)=∞$ならば
$$
μ(\bigcap_{n=1}^∞A_n)=\lim_{n→∞}μ(A_n)
$$

## 測度空間

可測空間$(X,\mathfrak{M})$に写像$μ:\mathfrak{M}→R$が以下を満たすとき、μを測度といい、$(X,\mathfrak{M},μ)$を __測度空間__ という。

1. $μ(\varnothing)=0$
2. 互いに素な集合の列$A_n\in\mathfrak{M}$に対し、$μ(\bigcup_n A_n)=\sum_nμ(A_n)$

よってルベーグ測度を入れた空間$(R,\mathfrak{M},μ)$は測度空間である。

また、他にも

## 拡大実数$\bar R$

$R=(-∞,∞)$であるが拡大実数$\bar R$とは∞を認めた実数である。つまり$\bar R=R\cup \lbrace -∞,∞\rbrace$となる。

## 可測関数

$(R,\mathfrak{M})$の可測空間において、$X\in\mathfrak{M}$上の関数$f:X→\bar R$が __可測関数__ であるとは、任意の$a\in R$に対して
$$
\lbrace x\in X| f(x)>a\rbrace
$$
が可測集合であることを言う。

また、$f:X→\bar R$を拡張して$f':R→\bar R,f'(x)=f(x)(x\in X),f'(x)=0(x\in X^c)$とすればリーマン積分の場合を考えれば分かるように、積分の値に影響しない。よって __関数の定義域はRに限定しても一般性を失わない。__

ちなみに
$$
\lbrace x\in X| f(x)>a\rbrace
$$
の$f(x)>a$を$f(x)\geqq a,f(x)<a,f(x)\leqq a$などに変えても同値である。

## 可測関数により定義される関数の可測性

f,gを可測関数とする。ここで関数の四則演算を$(f+g)(x):=f(x)+g(x)$のように定義すると以下の性質が成り立つ。
* kfのように定数倍しても可測関数。
* 関数f+gも可測関数
* 関数$f\cdot g$も可測関数
* 関数$\frac{f}{g}$も可測関数。ただし$g(x)\neq0$

また、$f_+:=max(f(x),0)$と置き、これをfの __正成分__ という。要は$f(x)$が０以上なら$f_+=f$でそうでないxについては$f_+=0$である。同様に$f_-$を関数$-f$の正成分を __負成分__ という。以下の定理が成り立つ。

* fが可測関数なら、fの正成分及びfの負成分も可測関数。

fの正成分及びfの負成分も可測関数なので$f_+f_-=|f|$より

* fが可測関数なら、$|f|$も可測関数。

また、__fが連続関数なら可測関数__。

## いたるところで等しい

2つの関数f,gが __いたるところで等しい__ とは
$$
μ^\ast(\lbrace x|f(X)\neq g(x)\rbrace)=0
$$
が成り立つ時をいい、fが可測関数ならgも可測関数になる。

## 特性関数と単関数

__特性関数__ $χ_A(x)$とは$A\subset X$に対し、
$$
χ_A:X→R \quad χ_A(x)=1(x\in A),0(x\in A^c)
$$
なる関数を言う。

__単関数__ $s(x)$とは、関数sが互いに素な$A_1,\cdots ,A_N\subset X$に対し、
$$
s:X→R \quad s(x)=\sum_{i=1}^Na_iχ_{A_i}
$$
と表されることをいう。$A_i$に特に制限はないため、$s(x)$は一意には定まらないので注意。

定義より単関数が可測関数になるには任意の$i$に対し、
$$
\lbrace x\in X| f(x)=a_i\rbrace
$$
が可測集合になることを言う。

## 非負値単関数のルベーグ積分

非負値単関数$s(x)=\sum_{i=1}^Na_iχ_{A_i}$が可測関数の時、そのルベーグ積分は
$$
\int_As(x)dx=\sum_{i=1}^Na_i×μ(A_i)
$$
を可測単関数sのA上の __ルベーグ積分__ という。ちなみに、積分の結果は拡張実数で扱われるため、∞を含む値も有効な結果として扱われます。ただし、拡張実数にはいくつかの演算規則があるので、注意が必要です。例えば、$0×∞=0$、$∞+∞=∞$、$∞-∞=not defined$などが挙げられます。また、$a_i×μ(A_i)>0$から、シグマの中に$-∞$が含まれることはないので、可測単関数sの積分結果は必ず存在することになります。

## 非負値可測関数のルベーグ積分

非負値可測関数のルベーグ積分は、$f$を$A$上の関数としAを任意の$A_i(i=1,2,\cdots .n)$に直和分割する。$a_k:=inf_{x\subset A_k}(f(x))$とすると、
$$
\int_Af(x)dx:=sup(\sum_{i=1}^na_kμ(A_k)) 
$$

と定義される。

非負値可測関数$f$は、ある非負単関数列$\lbrace f_n\rbrace$が存在し、以下の定理が成り立つ。

* 任意のnに対して$f_n$は可測関数
* $\lbrace f_n\rbrace$は広義単調増加(ただしいたるところで等しい場合も広義単調増加と認める)
* $\lim _{n→∞}f_n=f\quad a.e.$(a.e.とはいたるところで等しい場合の記号)

が成り立つ。また、積分結果は単関数の表示形式によらない事が知られている。さらにファトゥの補題(後述する)と組み合わせれば
$$
\int_Af(x)dx=\lim_{n→∞}\int_Af_n(x)
$$
が成り立つ。

## 可測関数のルベーグ積分

可測関数$f$は可測な正成分と負成分によって$f=f_+-f_-$と分解出来る為、一般の可測関数の積分は以下のように定義される。
$$
\int_Af(x)dx=\int_Af_+(x)dx-\int_Af_-(x)dx
$$

よって積分結果は$\int_Af_+(x)dx\neq ∞$または$\int_Af_-(x)dx\neq ∞$となる場合に存在します。

## ファトゥの補題

非負可測関数列$\lbrace f_n\rbrace$に対し、
$$
\int(\liminf_{n→∞}f_n)dx\leqq\liminf_{n→∞}\int f_ndx
$$
が成り立つ。$\liminf_{n→∞}a_n$は$\inf(a_∞(x))$のことである。

## 項別積分

非負可測関数列$\lbrace f_n\rbrace$とする。この時、
$$
\int\sum_{n=1}^∞f_ndx=\sum_{n=1}^∞\int f_ndx
$$
が成り立つ。ただし、$\sum_{n=1}^∞f_n$は収束する(拡大実数なので∞及び-∞も収束である。)か$∞-∞$領域の測度は0でなければ左辺の積分値は存在しないため、右辺も存在しなくなる。

また、より一般に可測関数列$\lbrace f_n\rbrace$とする。ここで
$$
\sum_{n=1}^∞\int |f_n|dx<∞
$$
ならば積分結果は存在し、
$$
\int\sum_{n=1}^∞f_ndx=\sum_{n=1}^∞\int f_ndx
$$