<!DOCTYPE html>
<html>
<head>
<title>チートシート.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>
<link rel="stylesheet" href="file:///d%3A/%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%80%E3%82%A6%E3%83%B3/practice/github-markdown.css" type="text/css">
<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://yukimaru77.github.io/practice/github-markdown.css">
<style>
.markdown-body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
}

@media (max-width: 767px) {
.markdown-body {
  padding: 15px;
}
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
      ]
    });
  });
  elements = document.getElementsByTagName("h2");
  console.log(elements)

</script>
</head>
<body>
  <article class="markdown-body">
<h1 id="%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E5%88%B6%E5%BE%A1%E2%85%B1">システム制御Ⅱ</h1>
<h2 id="%E4%B8%AD%E9%96%93%E7%B7%A8">----------中間編----------</h2>
<h2 id="%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%BC%8F%E3%81%8B%E3%82%89%E7%8A%B6%E6%85%8B%E6%96%B9%E7%A8%8B%E5%BC%8F%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9">微分方程式から状態方程式の求め方</h2>
<p>一番高い階数の微分以外に状態量を割り当てるだけ。形は
$$
\begin{aligned}
&amp;\bold{X'(t)}=A\bold{X(t)}+Bu(t) \cr
&amp;Y(t)=CX(t)+Du(t)
\end{aligned}
$$
なお、$Du(t)$は直立項と呼ばれる。出力に入力が定数倍されてそのまま出る部分。</p>
<p>例えばRLC直列回路の場合
$$
e(t)=Ri(t )+Li(t)'+\frac{1}{c}\int_{0}^{t}i(t)dt
$$
となるが、変形して
$$
\frac{1}{L}e(t)=\frac{R}{L}i(t )+i(t)'+\frac{1}{cL}\int_{0}^{t}i(t)dt
$$
入力を$e(t)$、出力を$y(t)=\int_{0}^{t}i(t)dt$だとおもうと
$$
\frac{1}{L}e(t)=y''+\frac{R}{L}y'+\frac{1}{cL}y
$$
となる。ここで一番高い階数の微分以外に状態量を割り当ててる。つまり
$$
x_1=y、x_2=y'、X=
\begin{pmatrix}
x_1 \cr
x_2
\end{pmatrix}
$$
とおくと、
$$
X'=\begin{pmatrix}
1 &amp; 0 \cr
-\frac{1}{cL} &amp; -\frac{R}{L}
\end{pmatrix}X+\begin{pmatrix}
0 \cr
\frac{1}{L}
\end{pmatrix}u(t)
$$
となる。</p>
<h2 id="eat%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9%E5%AF%BE%E8%A7%92%E5%8C%96%E3%81%A7">$e^{At}$の求め方(対角化で)</h2>
<p>公式は
$$e^{At}=Te^{Bt}T^{-1}$$
なお、
$$T^{-1}AT=B$$
である。証明は
$$
\begin{aligned}
e^{At}&amp;=I+At+\frac{A^2}{2!}t^2+\frac{A^3}{3!}t^3+\cdots \cr
&amp;=TT^{-1}+TBT^{-1}t+\frac{TB^2T^{-1}}{2!}t^2+\frac{TB^3T^{-1}}{3!}t^3+\cdots \cr
&amp;=T(I+Bt+\frac{B^2}{2!}t^2+\frac{B^3}{3!}t^3+\cdots)T^{-1} \cr
&amp;=Te^{Bt}T^{-1}
\end{aligned}
$$</p>
<p>ただしBは例えば$B= \begin{pmatrix} 1 &amp; 0 \cr 0 &amp; -2 \end{pmatrix}$のような対角行列なので$e^{Bt}$は簡単に
$$e^{Bt}=
\begin{pmatrix}
e^{t} &amp; 0 \cr
0 &amp; e^{-2t}
\end{pmatrix}$$
となる。</p>
<h2 id="eat%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9%E3%83%A9%E3%83%97%E3%83%A9%E3%82%B9%E5%A4%89%E6%8F%9B%E3%81%A7">$e^{At}$の求め方(ラプラス変換で)</h2>
<p>公式は
$$e^{At}=\mathcal{L}^{-1}[(sI-A)^{-1}]$$
証明は$u(t)=0$とすると
$$X'=AX$$
となるのでラプラス変換して
$$sX(s)-X_0=AX(s) →(SI-A)X(s)=X_0$$
逆行列を左からかけて
$$X(s)=(SI-A)^{-1}X_0$$
よって$u(t)=0$ならば
$$X(t)=\mathcal{L}^{-1}[(sI-A)^{-1}]X_0$$
ここで$X$の一般解は
$$X(t)=e^{At}X_0+\int_{0}^{t} e^{A(t-τ)}bu(τ) dτ \underset{u(τ)=0}{\longrightarrow} X(t)=e^{At}X_0$$
なので比較して
$$e^{At}=\mathcal{L}^{-1}[(sI-A)^{-1}]$$
となる。</p>
<h2 id="%E7%8A%B6%E6%85%8B%E6%96%B9%E7%A8%8B%E5%BC%8Fboldx%E3%81%AE%E4%B8%80%E8%88%AC%E8%A7%A3%E7%A9%8D%E5%88%86%E3%81%A7">状態方程式$\bold{x}$の一般解(積分で)</h2>
<p>公式は
$$
X=e^{At}X_0+\int_{0}^{t} e^{A(t-τ)}Bu(τ) dτ
$$
なので$e^{At}$さえわかれば頑張るだけ。なお、$\int_{0}^{t} e^{A(t-τ)}Bu(τ) dτ$を忘れたときは、
$$
\int_{0}^{t} x(t-τ)y(τ) dτ = \mathcal{L}^{-1}[XY]
$$
の関係式を思い出して
$$
\mathcal{L}^{-1}[(sI-A)^{-1}BU(s)] \underset{X=(sI-A)^{-1}、Y=BU(s)}{\longrightarrow} \int_{0}^{t} e^{A(t-τ)}Bu(τ) dτ
$$
とすれば導ける。ラプラス変換の式は次の項へ↓</p>
<h2 id="%E7%8A%B6%E6%85%8B%E6%96%B9%E7%A8%8B%E5%BC%8Fboldx%E3%81%AE%E4%B8%80%E8%88%AC%E8%A7%A3%E3%83%A9%E3%83%97%E3%83%A9%E3%82%B9%E5%A4%89%E6%8F%9B%E3%81%A7">状態方程式$\bold{x}$の一般解(ラプラス変換で)</h2>
<p>公式は
$$
X(t)=\mathcal{L}^{-1}[(sI-A)^{-1}]X_0+\mathcal{L}^{-1}[(sI-A)^{-1}BU(s)]
$$
忘れたときは
$$
\bold{X'(t)}=A\bold{X(t)}+Bu(t)
$$
をラプラス変換して
$$
sX(s)-X_0=AX(s)+BU(s) {\longrightarrow} (sI-A)X(s)=X_0+BU(s)
$$
より$(sI-A)^{-1}$を左からかけて
$$
X(s)=(sI-A)^{-1}X_0+(sI-A)^{-1}BU(s)
$$
逆ラプラス変換して
$$
X(t)=\mathcal{L}^{-1}[(sI-A)^{-1}]X_0+\mathcal{L}^{-1}[(sI-A)^{-1}BU(s)]
$$</p>
<h2 id="%E5%87%BA%E5%8A%9B%E6%96%B9%E7%A8%8B%E5%BC%8F%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9">出力方程式の求め方</h2>
<p>$$
Y(t)=CX(t)+Du(t)
$$
に代入するだけ。</p>
<h2 id="%E3%83%95%E3%83%AB%E3%83%A9%E3%83%B3%E3%82%AF">フルランク</h2>
<p>$A$を$n×m$行列する。Aのフルランクとは
$$
rank(A)=min(n,m)
$$
のことを言う。なお、<strong>ランクは転置しても変わらない</strong></p>
<p>もし$n=m$なら
$$
rank(A)=n \Leftrightarrow det(A) \ne 0
$$
正方行列がフルランクか調べるなら大抵$det(A) \ne 0$を使った方が早い。問題はせいぜい4×4とかの行列だから。</p>
<h2 id="%E7%B7%9A%E5%BD%A2%E7%8B%AC%E7%AB%8B">線形独立</h2>
<p>$A$を$n×m$行列する。ここで
$$
rank(A)=k
$$
だったとする。ここで<strong>列ベクトル</strong>が線形独立なのかを調べるには(列は縦)
$$
k=m \Leftrightarrow \bold{列ベクトル}が線形独立
$$
を調べればいい。ランクは意味を持つ式の本数なので列数=ランクとなればすべての列ベクトルは意味を持つことになる。</p>
<p>逆に<strong>行ベクトル</strong>が線形独立なのかを調べるには(行は横)
$$
k=n \Leftrightarrow \bold{行ベクトル}が線形独立
$$
を調べればいい。ランクは意味を持つ式の本数なので行数=ランクとなればすべての行ベクトルは意味を持つことになる。</p>
<h2 id="%E5%8F%AF%E5%88%B6%E5%BE%A1%E3%81%AE%E5%88%A4%E5%AE%9A%E3%82%84%E3%82%8A%E6%96%B9%E3%81%9D%E3%81%AE1">可制御の判定(やり方その1)</h2>
<p>定理
$$
行列e^{At}Bの\bold{行ベクトル}が線形独立ならば可制御
$$</p>
<p>よって $e^{At}B$のランクを求めて<strong>行数と一致するか調べる</strong>。問題で既に$e^{AT}$を求めたならこっちの方が楽かな？</p>
<p>可制御はかせい&quot;ぎょう&quot;で調べる。と覚える。</p>
<h2 id="%E5%8F%AF%E5%88%B6%E5%BE%A1%E3%81%AE%E5%88%A4%E5%AE%9A%E3%82%84%E3%82%8A%E6%96%B9%E3%81%9D%E3%81%AE2">可制御の判定(やり方その2)</h2>
<p>状態変数の数(=Aの列数)をnとする。
$$M_C=\begin{pmatrix}
b &amp; Ab &amp; \dots  &amp; A^{n-1}b \cr
\end{pmatrix}$$
とすると
$$ rankM_c=n$$
が成立すれば可制御。行フルランクともいうらしい。$e^{AT}$を求てないならこっちの方が楽かな？</p>
<h2 id="%E5%8F%AF%E8%A6%B3%E6%B8%AC%E3%81%AE%E5%88%A4%E5%AE%9A%E3%82%84%E3%82%8A%E6%96%B9%E3%81%9D%E3%81%AE1">可観測の判定(やり方その1)</h2>
<p>定理
$$
行列Ce^{At}の\bold{列ベクトル}が線形独立ならば可制御
$$</p>
<p>よって $Ce^{At}$のランクを求めて<strong>列数と一致するか調べる</strong>。問題で既に$e^{AT}$を求めたならこっちの方が楽かな？</p>
<h2 id="%E5%8F%AF%E8%A6%B3%E6%B8%AC%E3%81%AE%E5%88%A4%E5%AE%9A%E3%82%84%E3%82%8A%E6%96%B9%E3%81%9D%E3%81%AE2">可観測の判定(やり方その2)</h2>
<p>状態変数の数(=Aの列数)をnとする。
$$M_O=\begin{pmatrix}
C  \cr
CA \cr
\dots \cr
CA^{n-1} \cr
\end{pmatrix}$$
とすると
$$ rankM_c=n$$
が成立すれば可制御。列フルランクともいうらしい。$e^{AT}$を求てないならこっちの方が楽かな？</p>
<h2 id="%E6%9C%9F%E6%9C%AB%E7%B7%A8">----------期末編----------</h2>
<h2 id="%E5%BA%A7%E6%A8%99%E5%A4%89%E6%8F%9B">座標変換</h2>
<p>$$
\begin{aligned}
&amp;\bold{X'(t)}=A\bold{X(t)}+Bu(t) \cr
&amp;Y(t)=CX(t)+Du(t)
\end{aligned}
$$
に対し、$\bold{X(t)=TZ(t)}$の線形変換を定義すると
$$
\begin{aligned}
&amp;\bold{TZ'(t)}=A\bold{TZ(t)}+Bu(t) \cr
&amp;Y(t)=C\bold{TZ(t)}+Du(t)
\end{aligned}
$$
となり、左から$\bold{T^{-1}}$をかけて
$$
\begin{aligned}
&amp;\bold{Z'(t)}=\bold{T^{-1}ATZ(t)}+\bold{T^{-1}}Bu(t) \cr
&amp;Y(t)=C\bold{TZ(t)}+Du(t)
\end{aligned}
$$
となる。$\bar{A}=\bold{T^{-1}AT}、\bar{B}=\bold{T^{-1}}B、\bar{C}=C\bold{T}$と置けば</p>
<p>$$
\begin{aligned}
&amp;\bold{Z'(t)}=\bar{A}\bold{Z(t)}+\bar{B}u(t) \cr
&amp;Y(t)=\bar{C}Z(t)+Du(t)
\end{aligned}
$$</p>
<p>となる。なお、$\bar{A}=\bold{T^{-1}AT}$は<a href="https://yukimaru77.github.io/practice/%E7%B7%9A%E5%BD%A2%E4%BB%A3%E6%95%B0(%E3%83%A1%E3%83%A2)/%E7%B7%9A%E5%BD%A2%E4%BB%A3%E6%95%B0(%E3%83%A1%E3%83%A2).html#%E7%9B%B8%E4%BC%BC%E3%81%AA%E8%A1%8C%E5%88%97">相似な行列</a>の定義そのもので固有値(=固有多項式)や行列式等の行列関係の諸量は等しくなる。固有ベクトルは$\bold{T^{-1}}$を掛けた値となる。</p>
<h2 id="%E5%8F%AF%E5%88%B6%E5%BE%A1%E6%AD%A3%E6%BA%96%E5%BD%A2%E3%81%A8%E3%81%AF">可制御正準形とは</h2>
<p>座標変換のうち特に
$$
\begin{aligned}
&amp;\bold{Z'(t)}={{\begin{pmatrix} 0 &amp; 1 &amp; 0 &amp; \qquad &amp;0 \cr
0 &amp; 0 &amp; 1 &amp; \qquad &amp;0 \cr
0 &amp; 0 &amp; 0 &amp; \ddots &amp;0 \cr
\vdots &amp; &amp; &amp; \ddots &amp;1 \cr
-α _ 0 &amp; -α _ 1 &amp; -α _ 2 &amp; \cdots &amp; -α _ {n-1}
\end{pmatrix}}}\bold{Z(t)}+{\begin{pmatrix}
0 \cr
0 \cr
\vdots \cr
0 \cr
1
\end{pmatrix}}u(t) \cr \cr
&amp;Y(t)={\begin{pmatrix} β _ 1 &amp; β _ 2 &amp;\cdots &amp; β _ n\end{pmatrix}}
Z(t)+Du(t)
\end{aligned}
$$
と <strong>表せる時</strong> 、この表現形式を可制御正準形という。固有方程式は$\bold{A}、\bold{\bar{A}}$について、座標変換後も相似な行列の性質より不変な事に注意すると
$$
|sI-A|=|sI-\bar{A}|=s^n+a _ {n-1}s^{n-1}+\cdots +a _ 1s+a _ 0=0
$$
となり、伝達関数は
$$
G(s)=\frac{β _ ns^{n-1}+β _ {n-1}s^{n-2}+\cdots +β _ 2s+β _ 1}{s^n+a _ {n-1}s^{n-1}+\cdots +a _ 1s+a _ 0}
$$
となる。分子の方が次数が小さいので注意。テストで出るようなシステム制御の問題は基本プロパー(分子の次数＜分母の次数)になる(気がする)。</p>
<h2 id="%E4%BC%9D%E9%81%94%E9%96%A2%E6%95%B0">伝達関数</h2>
<p>伝達関数は
$$
G(s)=\frac{β _ ns^{n-1}+β _ {n-1}s^{n-2}+\cdots +β _ 2s+β _ 1}{s^n+a _ {n-1}s^{n-1}+\cdots +a _ 1s+a _ 0}
$$
となるが、普通に元の式をラプラス変換すれば
$$
\bold{C}(s\bold{I-A})^{-1}\bold{B}U(s)
$$</p>
<p>となることにも注意。</p>
<h2 id="%E5%8F%AF%E5%88%B6%E5%BE%A1%E6%AD%A3%E6%BA%96%E5%BD%A2%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9%E3%81%9D%E3%81%AE1">可制御正準形の求め方その1</h2>
<p>$$
\begin{aligned}
&amp;\bold{X'(t)}=A\bold{X(t)}+Bu(t) \cr
&amp;Y(t)=CX(t)+Du(t)
\end{aligned}
$$
を
$$
\begin{aligned}
&amp;\bold{Z'(t)}={{\begin{pmatrix}
0 &amp; 1 &amp; 0 &amp; \qquad &amp;0 \cr
0 &amp; 0 &amp; 1 &amp; \qquad &amp;0 \cr
0 &amp; 0 &amp; 0 &amp; \ddots &amp;0 \cr
\vdots &amp; &amp; &amp; \ddots &amp;1 \cr
-α _ 0 &amp; -α _ 1 &amp; -α _ 2 &amp; \cdots &amp; -α _ {n-1}
\end{pmatrix}}}\bold{Z(t)}+{\begin{pmatrix}
0 \cr
0 \cr
\vdots \cr
0 \cr
1
\end{pmatrix}}u(t) \cr \cr
&amp;Y(t)={\begin{pmatrix} β _ 1 &amp; β _ 2 &amp;\cdots &amp; β _ n\end{pmatrix}}Z(t)+Du(t)
\end{aligned}
$$
に可制御正準形に座標変換するには$\bold{X(t)=TZ(t)}$の$\bold{T}$を知る必要がある。$\bold{T}$は
$$
\bold{T}=
{\begin{pmatrix}
b &amp; Ab &amp; \dots  &amp; A^{n-1}b \cr
\end{pmatrix}}{{\begin{pmatrix}
a _ {1} &amp; \cdots &amp; a _ {n-1} &amp; 1 \cr
\vdots &amp; a _ {n-1} &amp; 1 &amp; 0  \cr
a _ {n-1} &amp; 1 &amp; 0 &amp; 0  \cr
1 &amp; 0&amp; 0&amp; 0
\end{pmatrix}}}
$$</p>
<p>で求められる。
$$
\bold{M _ c}={\begin{pmatrix}
b &amp; Ab &amp; \dots  &amp; A^{n-1}b \cr
\end{pmatrix}}、
\bold{Q}={{\begin{pmatrix}
a _ {1} &amp; \cdots &amp; a _ {n-1} &amp; 1 \cr
\vdots &amp; a _ {n-1} &amp; 1 &amp; 0  \cr
a _ {n-1} &amp; 1 &amp; 0 &amp; 0  \cr
1 &amp; 0&amp; 0&amp; 0
\end{pmatrix}}}
$$
と置くと、可制御正準形にするには$\bold{T}$には逆行列が存在しなければならないため、
$$
|T|=|M _ c||Q|\neq 0　\overrightarrow{} |M _ c|\neq 0
$$
となりこれはまさに<a href="https://yukimaru77.github.io/practice/%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E5%88%B6%E5%BE%A1%E2%85%A1/%E3%83%81%E3%83%BC%E3%83%88%E3%82%B7%E3%83%BC%E3%83%88.html#%E5%8F%AF%E5%88%B6%E5%BE%A1%E3%81%AE%E5%88%A4%E5%AE%9A%E3%82%84%E3%82%8A%E6%96%B9%E3%81%9D%E3%81%AE2">可制御の判定(やり方その2)</a>と同じことを言っている。</p>
<h2 id="%E6%AD%A3%E5%AE%9A%E5%80%A4%E8%A1%8C%E5%88%97%E3%81%AE%E5%88%A4%E5%AE%9A%E6%B3%95%E3%82%B7%E3%83%AB%E3%83%99%E3%82%B9%E3%82%BF%E3%83%BC%E3%81%AE%E5%88%A4%E5%AE%9A%E6%B3%95">正定値行列の判定法(シルベスターの判定法)</h2>
<p>$\bold{A}$が正定値行列がどうか調べたいとする。</p>
<ol>
<li>$\bold{A}$が対称行列なら次へ</li>
<li>$\bold{A}$の対角成分($a _ {ii}$のこと)がすべて正なら次へ</li>
<li>主座小行列を取り出し、それらの行列式がすべて正ならば$\bold{A}$は正定値行列</li>
</ol>
<p>例えば
$$
\bold{A}={\begin{pmatrix}
2 &amp; -1 &amp; 3 \cr
-1 &amp; 3 &amp; 1 \cr
3 &amp; 1 &amp; 1
\end{pmatrix}}
$$
の場合、対角成分は2、3、1よりすべて正なのでstep3へ
$$
a _ {11}=2&gt;0、det(
{\begin{pmatrix}
2 &amp; -1  \cr
-1 &amp; 3  \cr
\end{pmatrix}})=5&gt;0、det(
{\begin{pmatrix}
2 &amp; -1 &amp; 3 \cr
-1 &amp; 3 &amp; 1 \cr
3 &amp; 1 &amp; 1 \cr
\end{pmatrix}})=-30 &lt;0
$$
よりこの行列は正定値行列でない。</p>
<h2 id="%E5%8D%8A%E6%AD%A3%E5%AE%9A%E5%80%A4%E8%A1%8C%E5%88%97%E3%81%AE%E5%88%A4%E5%AE%9A%E6%B3%95">半正定値行列の判定法</h2>
<p>正定値行列の判定法で紹介した方法の&quot;正なら&quot;の部分を&quot;0以上なら&quot;に置き換えたものとなる。ただしステップ2か3に一回も0を含まない場合それは正定値行列なので一回は0が出てくる必要あり。</p>
<h2 id="%E5%AE%89%E5%AE%9A%E6%80%A7%E3%81%A8%E3%81%AF">安定性とは</h2>
<p>安定性には漸近安定やリアプノフ安定、不安定が存在する。これらの安定性は$\bold{A}$固有値を見ることで判定可能である。</p>
<ul>
<li>固有値の実部がすべて0以下ならリアプノフ安定</li>
<li>固有値の実部がすべて負なら漸近安定</li>
<li>固有値の実部に正を含むなら不安定</li>
</ul>
<p>リアプノフの定理は固有値を見ずに漸近安定なのか不安定なのかを見ようというコンセプトの定理。システム制御においては入力を0にした際の安定性のことを言っており入力を0にしてほっといたら0に行くのかそれともどっかに発散するのかを聞いている。例えばドローンの電源の落としたら落ち続ける。これは発散であり逆に電気回路なんかは電源を0にすれば出力もいずれ0になる。これは安定。システム制御における安定性は&quot;入力を0にしたら出力も0にいくのか？&quot;やステップ関数を入力したらある一定値に収束するのか？&quot;や&quot;有限値を入力したら出力も有限値になるのか？&quot;等の指標がある。結局全部等価だったような気がしなくもない。。。</p>
<p>なお、リアプノフ安定は遠ざかりはしない、漸近安定は収束する、不安定は発散するといったイメージ</p>
<p>さらに、イメージとして$\bold{A}$を表現行列とした線形変換を考えると固有値に虚数を含む場合は渦巻き状になるが実部が正の場合は外方向に放出される感じの渦巻き、負の場合は渦潮のように内側に吸い込まれる渦巻き、0の場合は位置ベクトルに常に垂直に回る円模様になるのでイメージに一致するし、固有値がすべて実数で正ならその固有ベクトルの写像は常に外側に伸びて発散し、負ならその固有ベクトルは常に原点に戻されるかの様な形になるので収束する。これもイメージと一致する。<a href="https://math-fun.net/20180720/789/">イメージ図はこちら</a></p>
<h2 id="%E3%83%AA%E3%82%A2%E3%83%97%E3%83%8E%E3%83%95%E3%81%AE%E5%AE%9A%E7%90%86">リアプノフの定理</h2>
<p>任意の正定行列$\bold{Q}$に対して
$$
^t\bold{AP+PA}=-\bold{Q}
$$
を満足する 正定行列 $\bold{P}$が存在する時、漸近安定となる。これをリアプノフの定理という。</p>
<p>よって$\bold{A}$を与えられたとき、てきとうに正定行列$\bold{Q}$を決め$\bold{P}$を求め、その$\bold{P}$が正定行列なのかシルベスターの判定法で判定する。</p>
<h2 id="%E5%8F%AF%E8%A6%B3%E6%B8%AC%E6%AD%A3%E6%BA%96%E5%BD%A2">可観測正準形</h2>
<p>システムの可制御正準形は
$$
\begin{aligned}
&amp;\bold{Z'(t)}={{\begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; \qquad &amp;-α _ 0 \cr
1 &amp; 0 &amp; 0 &amp; \qquad &amp;-α _ 1 \cr
0 &amp; 1 &amp; 0 &amp; \qquad &amp;-α _ 2 \cr
\vdots &amp; &amp; \ddots&amp; \ddots &amp;\vdots \cr
0 &amp; 0 &amp; \cdots &amp; 1 &amp; -α _ {n-1}
\end{pmatrix}}}\bold{Z(t)}+{\begin{pmatrix}
β _ 1 \cr
β _ 2 \cr
\vdots \cr
\vdots \cr
β _ n
\end{pmatrix}}u(t) \cr \cr
&amp;Y(t)={\begin{pmatrix} 0 &amp; 0 &amp;\cdots &amp; 1\end{pmatrix}}Z(t)
\end{aligned}
$$
の形をしたシステムのことを言う。これは可制御正準形の双対になっている。双対の話は補足で下の方にしてあるがまあ、可制御正準形の文字を使って書き表せることだけ知っておけば特に問題ない。</p>
<h2 id="%E5%8F%AF%E8%A6%B3%E6%B8%AC%E6%AD%A3%E6%BA%96%E5%BD%A2%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9">可観測正準形の求め方</h2>
<p>$\bold{T}^{-1}$は
$$
\bold{T}^{-1}=
{{\begin{pmatrix}
a _ {1} &amp; \cdots &amp; a _ {n-1} &amp; 1 \cr
\vdots &amp; a _ {n-1} &amp; 1 &amp; 0  \cr
a _ {n-1} &amp; 1 &amp; 0 &amp; 0  \cr
1 &amp; 0&amp; 0&amp; 0
\end{pmatrix}}\begin{pmatrix}
C  \cr
CA \cr
\dots \cr
CA^{n-1} \cr
\end{pmatrix}}
$$
で求められる。可観測正準形は$\bold{T}^{-1}$がまず求まることに注意。</p>
<h2 id="%E6%A5%B5%E3%81%A8%E3%83%95%E3%82%A3%E3%83%BC%E3%83%89%E3%83%90%E3%83%83%E3%82%AF">極とフィードバック</h2>
<p>システムにおいて安定性は極が決定している。よって極を任意に配置できるようなフィードバックがあればシステムを安定にすることが出来る。ここからは極を任意に配置する方法を考える。</p>
<h2 id="%E7%8A%B6%E6%85%8B%E3%83%95%E3%82%A3%E3%83%BC%E3%83%89%E3%83%90%E3%83%83%E3%82%AF">状態フィードバック</h2>
<p>状態フィードバックとは入力uに状態変数xにfベクトル($f=[f_1 \quad f_2 \quad\cdots f_n]$)をかけたものを入力とする方法である。よって仮定として状態変数xが全て観測可能出なければならない。</p>
<p>通常、状態変数xはには様々な変数が含まれる。例えば機体の角度θ、タイヤの回転角度Φ、プロペラの回転数ωなど。普通これらすべてを観測するには様々な観測機器を用い無ければならず、全てが観測出来ることは稀なのは容易に想像はつくだろう。しかしまずは状態変数xが全て観測可能とする。</p>
<p>$$
\bold{X'(t)}=A\bold{X(t)}+Bu(t)
$$
のuにfxを代入して
$$
\bold{X'(t)}=(A+Bf)\bold{X(t)}
$$
となる。さらに可制御正準形に変形すると、
$$
\bold{X'(t)}=(A+Bf)\bold{X(t)}\quad→ \quad
\bold{Z'(t)}=(\bar A+\bar B\bar f)\bold{Z(t)}
$$
となる。ここで$\bar f=fT$である。$(\bar A+\bar B\bar f)$の固有多項式は計算すると
$$
S^n+(α_{n-1}-\bar{f_n})s^{n-1}+\cdots +(α_{1}-\bar{f_2})s+(α_0-\bar{f_1})=0
$$
となる。よってfの要素ですべての係数を任意に操作できるため極を操作可能。よって可制御正の場合は極を任意に操作可能。</p>
<h2 id="%E3%82%AA%E3%83%96%E3%82%B6%E3%83%BC%E3%83%90">オブザーバ</h2>
<p>先ほども述べたように一般に、状態変数は直接観測できない。しかし、状態フィードバックは安定性のために施したいが肝心な状態変数がわからない。よって状態変数の&quot;推定量&quot;を求めることを考える。推定量が正しく推定できているならそれをフィードバックすることで状態フィードバックと同じ結果を得られるはずでだからである。</p>
<p>ここで、作為的ではあるがxの推定量(オブザーバ)$\hat{x}$は元のシステムの文字とkベクトル($k={}^T[k_1 \quad k_2 \quad\cdots k_n]$)を用いて、以下のシステムによって与えられるものと定義する。オブザーバが正しくxを推定できるようなkが存在するか確認する。</p>
<p>$$
\dot{\hat{x}}=A\hat{x}+Bu(t)+K(y(t)-C\hat{x})
$$</p>
<p>誤差eは$e(t)=x(t)-\hat{x}(t)$とすれば、
$$
\begin{aligned}
\dot e(t)&amp;=\dot x(t)-\dot{\hat{x}}\cr
&amp;=(A-KC)e(t)
\end{aligned}
$$
となる。よって$(A-KC)$が漸近安定であればどんな初期推定誤差e(0)に対してもt→∞とすれば0となる。ここで可観測正準形に変形すると、
$$
\dot e(t)=(A-KC)e(t)\quad→ \quad
\dot{\bar e}(t)=(\bar A-\bar K\bar C)\bar e(t)
$$
となる。ただし$K=T\bar K$である。$(\bar A-\bar K\bar C)$の固有多項式は計算すると
$$
S^n+(α_{n-1}+\bar{k_n})s^{n-1}+\cdots +(α_{1}+\bar{k_2})s+(α_0+\bar{k_1})=0
$$
となる。よってkの要素ですべての係数を任意に操作できるため誤差システムの極を操作可能。よって可観測の場合は極を任意に操作可能ためオブザーバはこの式で正しく設計できる。</p>
<h2 id="%E5%87%BA%E5%8A%9B%E3%83%95%E3%82%A3%E3%83%BC%E3%83%89%E3%83%90%E3%83%83%E3%82%AF%E5%89%87">出力フィードバック則</h2>
<p>状態変数を直接観測できなくても、オブザーバを設計すればそれは状態変数の推定値として使っていいことが前項で分かった。よってこのオブザーバ$\hat{x}$を状態フィードバックのxに代入し
$$
\begin{aligned}
&amp;u(t)=F\hat{x}\cr
&amp;\dot{\hat{x}}=A\hat{x}+Bu(t)+K(y(t)-C\hat{x})
\end{aligned}
$$
とする。これを出力フィードバック則という。出力フィードバック則によって設計したシステムの固有値と誤差システムの固有値は状態フィードバック則とオブザーバを独立に考えたときの固有値とそれぞれ等しくなり、これを分離原理という。</p>
<h2 id="%E8%A3%9C%E8%B6%B3">------------補足---------------</h2>
<h2 id="%E5%8F%AF%E5%88%B6%E5%BE%A1%E6%80%A7%E3%81%A8%E3%81%AF">可制御性とは</h2>
<p>すべての初期状態x(0)を、ある有限な時刻$t_f$の間に、任意に与えられた状態$x_f$に移すような操作量$u(t)、0\leqq t \leqq t_f$が存在し、$x(t_f)=x_f$
とできる時システムは可制御であるという。</p>
<p>対角正準形を用いて任意の$b_i (i=1、2、\cdots 、n)\neq0$について成り立つ時、可制御という。とも定義できる。つまり対角正準形の時にすべてのモード$z_i (i=1、2、\cdots 、n)$に入力$u(t)$を影響させることが出来、 <strong>全ての状態変数に対し、入力を伝えれる</strong> という意味になる。</p>
<h2 id="%E5%8F%AF%E8%A6%B3%E6%B8%AC%E6%80%A7%E3%81%A8%E3%81%AF">可観測性とは</h2>
<p>ある有限な時刻$t_f$があり、$0\leqq t \leqq t_f$の愛仇のy(t)とu(t)から初期状態を一意に決定できる(=初期状態を知ることが出来る)時、システムは可観測であるという。</p>
<p>対角正準形を用いて任意の$c_i (i=1、2、\cdots 、n)\neq0$について成り立つ時、可観測という。例えば$c_1=0$であるならばどんなに出力y(t)を注意深く観察してもモード$z_1$の状態を知ることはできない。よって <strong>cに0を含むと、出力をどんなに注意深く見ても可観測出なくなる</strong> ことは想像できるだろう。</p>
<h2 id="%E5%8F%AF%E5%88%B6%E5%BE%A1%E6%80%A7%E3%82%B0%E3%83%A9%E3%83%9F%E3%82%A2%E3%83%B3%E5%8F%AF%E5%88%B6%E5%BE%A1%E6%80%A7%E3%82%B0%E3%83%A9%E3%83%A0%E8%A1%8C%E5%88%97">可制御性グラミアン(可制御性グラム行列)</h2>
<p>可制御性グラミアンまたは可制御性グラム行列$W_c(t)$は
$$
W_c(t)=\int_{0}^{t} (e^{-Aτ}b)(e^{-Aτ}b)^Tdτ
$$
と定義される行列である。ここで以下の関係が成立する。
$$
可制御性グラミアンが正則\Leftrightarrow システムは可制御である。
$$
証明は少しめんどくさいが(詳しくは書籍へ、わかりやすい現代制御理論 森 泰親P52~53)、</p>
<ol>
<li>
<p>$t=t_f$において、逆行列を作りたいため$W_c(t)$を正則と仮定し、入力を
$$
u(t)=-{}^T(e^{-At}b)W_c^{-1}(t_f)(x(0)-e^{-At}x_f)
$$
とおいてxの解を求めると実は$x_f$になる。(必要性)</p>
</li>
<li>
<p>システムが可制御であるのに$W_c(t)$がすべてのtにおいて正則でないと仮定し、矛盾を導く(具体的にはxのノルムが0になるが0ベクトルではないという結果になる)。(十分性)</p>
</li>
<li>
<p>正則となる$t=t_f$が存在するならすべての時刻$t&gt;0$で正則であることを示す。</p>
</li>
</ol>
<p>証明終了となる。ちなみにグラム行列とは<a href="https://math-fun.net/20210715/16275/">これのこと</a>。</p>
<h2 id="%E5%8F%AF%E5%88%B6%E5%BE%A1%E8%A1%8C%E5%88%97%E3%81%AE%E5%AE%9A%E7%90%86%E3%81%AE%E8%A8%BC%E6%98%8E">可制御行列の定理の証明</h2>
<p>可制御行列が正則の場合、システムは可制御になるがこれの証明を軽く行う。</p>
<p>可制御性グラミアンの証明のステップ2で$W_c(t)$がすべてのtにおいて正則でないと仮定した際の考察で
$$
^Txe^{-At}n=0
$$
が成り立つ0でないxの存在が導ける。(わかりやすい現代制御理論 森 泰親P53)</p>
<p>ここで、$
M_C=\begin{pmatrix}
b &amp; Ab &amp; \dots  &amp; A^{n-1}b \cr
\end{pmatrix}$が正則であるにも関わらずシステムが負可制御であるとする。すると可制御性グラミアンの項の結果より$W_c(t)$はすべてのtで正則でなくなる。つまり
$$
^Txe^{-At}n=0
$$
が成り立つ0でないxの存在が成り立つ。これをtで微分を繰りかえしt=0とすると
$$
\begin{aligned}
&amp;{}^Txb=0 \cr
&amp;{}^TxAb=0 \cr
&amp;{}^TxA^2b=0 \cr
&amp;\qquad \vdots \cr
&amp;{}^TxA^{n-1}b=0&amp;
\end{aligned}
$$
よって
$$
{}^Tx{\begin{pmatrix}
b &amp; Ab &amp; \dots  &amp; A^{n-1}b \cr
\end{pmatrix}}=0
$$
が成り立つがxは0でないので、$
M_C=\begin{pmatrix}
b &amp; Ab &amp; \dots  &amp; A^{n-1}b \cr
\end{pmatrix}$は正則でなくなる。よってシステムが不可制御とした仮定が間違えであり、可制御である。必要十分の証明にはなってないので続きを見たい人はわかりやすい現代制御理論 森 泰親P56~P57へ。</p>
<h2 id="%E6%AD%A3%E5%AE%9A%E5%80%A4%E8%A1%8C%E5%88%97%E3%81%AE%E5%AE%9A%E7%BE%A9">正定値行列の定義</h2>
<p>まず用語として、正定値とは符号が正のことを言う。</p>
<table>
<thead>
<tr>
<th>$a&gt;0$</th>
<th>aは正定</th>
</tr>
</thead>
<tbody>
<tr>
<td>$a\geqq0$</td>
<td>aは半正定値</td>
</tr>
<tr>
<td>$a&lt;0$</td>
<td>aは負定値</td>
</tr>
<tr>
<td>$a\leqq0$</td>
<td>aは半負定値</td>
</tr>
</tbody>
</table>
<p>ここでまず$\bold{A}\in{M(n,n)}、\bold{x}\in{R^n}$とする。つまり$\bold{A}$はn次正方行列、$\bold{x}$はn次元列ベクトルである。さらに$\bold{A}$は対称行列とする。つまり$^t\bold{A=A}$である。ここで列ベクトル$\bold{x、y}$の内積$&lt;\bold{x、y}&gt;$は
$$
&lt;\bold{x、y}&gt;={}^t\bold{xy}=\sum _ {k=1}^{n}x _ ky _ k
$$
である。$\bold{A}$が正定値行列であるとは列ベクトルの内積を用いて
$$
&lt;\bold{Ax、x}&gt;\quad&gt;0
$$
となる時を言う。ここで転置行列の性質とAは対称行列なので
$$
^t(\bold{Ax})={}^t\bold{x}{}^t\bold{A} \quad→ \quad{}^t(\bold{Ax})={}^t\bold{x}{}\bold{A}
$$
となるので
$$
&lt;\bold{Ax、x}&gt;={}^t\bold{x}{}\bold{A}\bold{x}&gt;0
$$
となる。なお$\bold{X}$は任意である。つまり2次形式が常に0より大きいと言ってもいい。</p>
<h2 id="%E6%AD%A3%E5%AE%9A%E5%80%A4%E8%A1%8C%E5%88%97%E3%81%AE%E6%80%A7%E8%B3%AA">正定値行列の性質</h2>
<p>$$
対称行列\bold{A}が正定値行列\iff 固有値がすべて正
$$</p>
<p>この性質は色々考え方はあるが例えば、固有値がすべて正でない場合、2次形式の変数は任意のため変数変換をして2次形式の中でも特に標準形に変換した場合、それらの係数の中に正でないものが含まれてしまい2次形式が常に0より大きいに明らかに反してしまう。</p>
<p>または、<a href="https://yukimaru77.github.io/practice/%E7%B7%9A%E5%BD%A2%E4%BB%A3%E6%95%B0/%E7%B7%9A%E5%BD%A2%E4%BB%A3%E6%95%B0.html#%E5%AF%BE%E7%A7%B0%E8%A1%8C%E5%88%97">対称行列は必ず直行行列で対角化可能</a>であり、<a href="https://yukimaru77.github.io/practice/%E7%B7%9A%E5%BD%A2%E4%BB%A3%E6%95%B0(%E3%83%A1%E3%83%A2)/%E7%B7%9A%E5%BD%A2%E4%BB%A3%E6%95%B0(%E3%83%A1%E3%83%A2).html#%E7%9B%B8%E4%BC%BC%E3%81%AA%E8%A1%8C%E5%88%97">相似な行列</a>の行列式は一定値より行列式とはすべての固有値の積であるので仮に固有値が0以下のものがある場合、主座小行列の行列式に0以下のものが出てしまいこれはシルベスターの判定法に反する。</p>
<h2 id="%E5%8F%AF%E5%88%B6%E5%BE%A1%E6%AD%A3%E6%BA%96%E5%BD%A2%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9%E3%81%9D%E3%81%AE2">可制御正準形の求め方その2</h2>
<p>$$
\begin{aligned}
&amp;\bold{X'(t)}=A\bold{X(t)}+Bu(t) \cr
&amp;Y(t)=CX(t)+Du(t)
\end{aligned}
$$
に対し、$\bold{t} _ i\quad (i=n、n-1、\cdots 、2)$を列ベクトルとする。ここで
$$
\bold{t} _ n=B , \bold{t} _ {i-1}=A\bold{t} _ i+α _ {i-1}\bold{t} _ i
$$
とすると
$$
\bold{T}=[\bold{t} _ n \quad \bold{t} _ {n-1} \quad \cdots \quad \bold{t} _ 1]
$$
となる。やってること自体はその1と同じ。例としてn=3ならば
$$
\begin{aligned}
&amp;\bold{t} _ 3=B \cr
&amp;\bold{t} _ 2=A\bold{t} _ 3+α _ 2\bold{t} _ 3 \cr
&amp;\bold{t} _ 1=A\bold{t} _ 2+α _ 1\bold{t} _ 2 \cr
&amp;\bold{T}=[\bold{t} _ 3 \quad \bold{t} _ 2 \quad \bold{t} _ 1]
\end{aligned}
$$
となる。</p>
<h2 id="%E5%8F%AF%E5%88%B6%E5%BE%A1%E6%AD%A3%E6%BA%96%E5%BD%A2%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9%E3%81%9D%E3%81%AE3">可制御正準形の求め方その3</h2>
<p>まず、可制御行列$M _ c$
$$M _ C=\begin{pmatrix}
b &amp; Ab &amp; \dots  &amp; A^{n-1}b \cr
\end{pmatrix}$$
の逆行列$M _ c^{-1}$を求める。$M _ c^{-1}$の第n行目の行ベクトルを$e$とおく。つまり一番下の行のことである。この$e$を用いると$T^{-1}$は
$$T^{-1}=\begin{pmatrix}
e \cr
eA \cr
\dots \cr
eA^{n-1} \cr
\end{pmatrix}$$
と求まる。ここで求まるのは$T^{-1}$なことに注意。</p>
<p>この求め方を見ると$M _ c^{-1}$の存在がないと可制御正準形に出来ないことが分かる。</p>
<h2 id="%E5%8F%AF%E8%A6%B3%E6%B8%AC%E6%AD%A3%E6%BA%96%E5%BD%A2%E3%81%A8%E5%8F%AF%E8%A6%B3%E6%B8%AC%E6%AD%A3%E6%BA%96%E5%BD%A2%E3%81%AE%E5%8F%8C%E5%AF%BE%E6%80%A7">可観測正準形と可観測正準形の双対性</h2>
<p>システム(A,B)の可制御性行列$M_C$の転置は
$${}^TM_C=\begin{pmatrix}
{}^TB  \cr
{}^TB{}^TA \cr
\vdots \cr
{}^TB({}^TA)^{n-1} \cr
\end{pmatrix}$$</p>
<p>となる。転置をとってもランクは変わらないため、これはシステム(C,A)の可観測行列と比べると、システム$({}^TB,{}^TA)$の可観測行列に対応することがわかる。同様にシステム(C,A)とシステム$({}^TA,{}^TC)$も双対である。</p>
<p>以上よりシステム1を以下の様に定義し、
$$
\begin{aligned}
&amp;\bold{X'(t)}=A\bold{X(t)}+Bu(t) \cr
&amp;Y(t)=CX(t)
\end{aligned}
$$
システム2を以下のように定義すると
$$
\begin{aligned}
&amp;\bold{X'(t)}={}^TA\bold{X(t)}+{}^TCu(t) \cr
&amp;Y(t)={}^TBX(t)
\end{aligned}
$$
システム1が可制御ならば、システム2は可観測になり、システム1が可観測ならシステム2は可制御になる。これは可観測正準形と可観測正準形の形が転置になっている理由でもある。</p>

</article>
</body>
<script>
	elements = document.getElementsByTagName("h2");
	table_of_contents = document.createElement("ul");
	h2=document.createElement("h2");
	h2.textContent="目次"
	table_of_contents.appendChild(h2)
	for (  var i = 0;  i < elements.length;  i++  ) {
		console.log(elements[ i ]);
		const newElement_li = document.createElement("li");
		const newElement_a = document.createElement("a");
		newElement_a.href="#"+elements[ i ].id;
		newElement_a.textContent = elements[ i ].textContent;
		newElement_li.appendChild(newElement_a);
		table_of_contents.appendChild(newElement_li);
		
	}
	parents=document.getElementsByClassName("markdown-body")[0];
	h1 = document.getElementsByTagName("h1")[0];
	parents.insertBefore(table_of_contents, h1.nextSibling)
</script>
</html>