<!DOCTYPE html>
<html>
<head>
<title>解析力学.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://yukimaru77.github.io/practice/github-markdown.css">
<style>
.markdown-body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
}

@media (max-width: 767px) {
.markdown-body {
  padding: 15px;
}
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
<!-- MathJaxのCDNリンクを追加 -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
      ]
    });
  });
  elements = document.getElementsByTagName("h2");
  console.log(elements)
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      Macros: {
        bra: ["\\langle {#1}|", 1],
        ket: ["|{#1}\\rangle", 1],
        braket: ["\\langle {#1}|{#2}\\rangle", 2],
				bold: ["\\mathbf{#1}", 1]
      }
    },
		tex2jax: {
			inlineMath: [ ['$','$'], ["\\(","\\)"] ],
			displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
		}
  });
</script>

</head>
<body>
  <article class="markdown-body">
<h1 id="%E8%A7%A3%E6%9E%90%E5%8A%9B%E5%AD%A6">解析力学</h1>
<h2 id="%E5%A4%89%E5%88%86">変分</h2>
<p>変分とは、ある量$A$を変化させたときに、その量に依存して決まる別の量$F(A)$がどのように変化するかを計算することである。つまり以下の式で表される。
$$
δF(A) = F(A + δA) - F(A)
$$
ここでもし$A$と$F(A)$が数値であれば、$δA$が十分に小さいとき、
$$
δF(A) = F'(A) δA
$$
となるため、微分と同じような役割を果たす。しかし、変分は$A$が関数である場合なども考えることができる。よって微分より広い概念である。</p>
<h2 id="%E9%9D%99%E5%8A%9B%E5%AD%A6">静力学</h2>
<p>静力学（statics）とは、平衡状態の物体に作用する力やモーメントを求める力学のことである。静力学は力のつり合いを考えることで解析することができる。</p>
<h2 id="%E5%8A%9B%E3%81%AE%E3%81%A4%E3%82%8A%E5%90%88%E3%81%84">力のつり合い</h2>
<p>系に作用する力の合計及びモーメントの合計がゼロであるとき、系は静力学的平衡にあるという。これを力のつり合いという。
$$
\sum \bold{F}_i = 0 \
\sum \bold{F}_i \times \bold{r}_i = 0
$$</p>
<h2 id="%E4%BB%AE%E6%83%B3%E4%BB%95%E4%BA%8B%E3%81%AE%E5%8E%9F%E7%90%86">仮想仕事の原理</h2>
<p>力が釣りあっている場合、実際に起こりうる仮想変位$δ\bold{r}_i$を与えたとき、系に働く力の仕事の合計はゼロであるという原理である。式にすると以下になる。
$$
\sum \bold{F}_i \cdot δ\bold{r}_i = 0 \leftrightarrow \sum \bold{F}_i =0 , \quad \sum \bold{F}_i \times \bold{r}_i = 0
$$</p>
<p>仮想仕事の場合、内力の仕事の合計が0となるため最初から考察の対象から除外できるという利点がある。</p>
<h2 id="%E4%BE%8B%E9%A1%8C1">例題1</h2>
<p>以下の例を考えよう。滑車と重り二つを系と見れば、外力は地球との相互作用である重力($m_1g、m_2g$)のみである。よって、仮想仕事の原理より、$m_1$の仮想変位を$δ\bold{r}_1$、$m_2$の仮想変位を$δ\bold{r}_2$とすると
$$
m_1g \cdot δ\bold{r}_1 + m_2g \cdot δ\bold{r}_2 = 0
$$
ここで、実際に起こりうる仮想変位は、$-2δ\bold{r}_1 = δ\bold{r}_2$である。よって代入して
$$
m_1g \cdot δ\bold{r}_1 - 2m_1g \cdot δ\bold{r}_1 = 0
$$
より
$$
m_1 = 2m_2
$$
となる。</p>
<p><img src="./画像1.png" alt=""></p>
<h2 id="%E4%BD%8D%E7%BD%AE%E3%82%A8%E3%83%8D%E3%83%AB%E3%82%AE%E3%83%BC%E3%81%A8%E4%BB%AE%E6%83%B3%E4%BB%95%E4%BA%8B%E3%81%AE%E5%8E%9F%E7%90%86">位置エネルギーと仮想仕事の原理</h2>
<p>位置エネルギーの変分を考えてみよう。なお、位置エネルギーが定義できない状態(ベクトル場$\vec A$に対して、$rot \vec A \neq 0$)は考えないことにする。
$$
\begin{align*}
δU &amp;= U(\bold{r} + δ\bold{r}) - U(\bold{r})\\
&amp;= grad U \cdot δ\bold{r}\\
&amp;= -\bold{F} \cdot δ\bold{r}
\end{align*}
$$</p>
<p>ここで仮想仕事は
$$
δW = F \cdot δ\bold{r}
$$</p>
<p>なので、
$$
δU = -δW
$$
となる。よって、位置エネルギーの変分は仮想仕事の符号を反転させたものになる。</p>
<h2 id="%E4%BE%8B%E9%A1%8C2">例題2</h2>
<p>ここで図のような状態を考える。なお、各バネの自然長は0でありバネ定数はkとし、重りは全てmとし両端の重りは固定されているとする。この問題を仮想仕事の原理で解くと、すべての重りを$δy_i$だけ動かす。ここで変位は微小なので各重りが仮想変位を与えられたとき、バネの向心力は変化しないとすると
$$
\sum_{i=2}^{N-1}(-mgδy_i+k(y_{i-1}-y_i)δy_i+k(y_{i+1}-y_i)δy_i)  =0
$$</p>
<p>となる。両端は固定されているため、仮想変位は2~N-1の範囲である。ここで、仮想変位$δy_i$は、それぞれ独立かつ任意であるため、解くべき式は
$$
-mg+k(y_{i-1}-y_i)+k(y_{i+1}-y_i)=0
$$
となる。</p>
<p>次に、位置エネルギーの変分を考える。$U_{重}(y_i)=mgy_i$であり、$U_{バネ}(y_i)=\frac{1}{2}k((y_{i+1}-y_i)^2+L^2)+\frac{1}{2}k((y_{i}-y_{i-1})^2+L^2)$なので、
$$
\sum -(δU_{重}(y_i) +δU_{バネ}(y_i)) = 0
$$
ここで$δU=grad U \cdot δ\bold{r}$であり、今回は1次元なので$grad$はただの微分になる。よって、
$$
\begin{align*}
\sum_{i=2}^{N-1} -(δU_{重}(y_i) +δU_{バネ}(y_i)) &amp;=\sum_{i=2}^{N-1} -(\frac{d}{dy_i} U_{重}(y_i)δy_i +\frac{d}{dy_i} U_{バネ}(y_i)δy_i) \\
&amp;=\sum_{i=2}^{N-1} -(\frac{d}{dy_i} U_{重}(y_i) +\frac{d}{dy_i} U_{バネ}(y_i))δy_i \\
&amp;=\sum_{i=2}^{N-1} (-mg+k(y_{i-1}-y_i)+k(y_{i+1}-y_i))δy_i \\
\end{align*}
$$
となり、同じ式が出てくる。</p>
<p>また、合計の位置エネルギーは
$$
U_{重all}(y_1,y_2,\cdots,y_N) = \sum_{i=1}^{N} U_{重}(y_i)
$$</p>
<p>ばねによる位置エネルギーの合計は
$$
U_{バネall}(y_1,y_2,\cdots,y_N) = \sum_{i=1}^{N} U_{バネ}(y_i)
$$</p>
<p>となる。これを合計すると
$$
U_{all}(y_1,y_2,\cdots,y_N) = U_{重all}(y_1,y_2,\cdots,y_N) + U_{バネall}(y_1,y_2,\cdots,y_N)
$$
となり、これの偏微分は
$$
\begin{align*}
\frac{\partial U_{all}}{\partial y_i} &amp;= \frac{\partial U_{重all}}{\partial y_i} + \frac{\partial U_{バネall}}{\partial y_i}\\
&amp;= \frac{\partial U_{重}(y_i)}{\partial y_i} + \frac{\partial U_{バネ}(y_i) }{\partial y_i} \\
&amp;= -mg + k(y_{i-1}-y_i) + k(y_{i+1}-y_i)
\end{align*}
$$
が0としても同じ式が出てくる。</p>
<p>つまり、全位置エネルギーの極値ならば少なくとも安定で、今回はたまたま仮想仕事の原理と同じだった？</p>
<p><img src="./画像2.jpg" alt=""></p>
<h2 id="%E6%B1%8E%E9%96%A2%E6%95%B0">汎関数</h2>
<p>汎関数とは、関数を入力として数値を出力する関数のことである。例えば、
$$
F[f(x)] = \int_{a}^{b} f(x) dx
$$
は、関数$f(x)$を入力として、数値を出力する関数である。このような関数を汎関数という。</p>
<h2 id="%E6%B1%8E%E9%96%A2%E6%95%B0%E3%81%AE%E5%A4%89%E5%88%86">汎関数の変分</h2>
<p>汎関数の変分は、以下のように定義される。
$$
δF[f(x)] = F[f(x) + δf(x)] - F[f(x)]
$$
ここで、$δf(x)$は任意の微小な数値を取る関数である。</p>
<h2 id="%E3%82%AA%E3%82%A4%E3%83%A9%E3%83%BC%E3%83%BB%E3%83%A9%E3%82%B0%E3%83%A9%E3%83%B3%E3%82%B8%E3%83%A5%E6%96%B9%E7%A8%8B%E5%BC%8F">オイラー・ラグランジュ方程式</h2>
<p>多変数汎関数$I(\lbrace x \rbrace,\lbrace \dot{x} \rbrace,t)$を以下のように定義する。
$$
I(\lbrace x \rbrace,\lbrace \dot{x} \rbrace,t) = \int_{t_1}^{t_2} L(\lbrace x \rbrace,\lbrace \dot{x} \rbrace,t) dt
$$
このとき、$I$の変分$δI=I(\lbrace x + δx \rbrace,\lbrace \dot{x} + δ\dot{x} \rbrace,t) - I(\lbrace x \rbrace,\lbrace \dot{x} \rbrace,t)$が0となるような$\lbrace x \rbrace$は以下の式で表される。
$$
\frac{\partial L}{\partial x_i} - \frac{d}{dt}\frac{\partial L}{\partial \dot{x}_i} = 0
$$
これをオイラー・ラグランジュ方程式という。</p>
<h2 id="%E4%BD%9C%E7%94%A8%E3%81%A8%E3%83%A9%E3%82%B0%E3%83%A9%E3%83%B3%E3%82%B8%E3%82%A2%E3%83%B3">作用とラグランジアン</h2>
<p>ここでの目標は、オイラー・ラグランジュ方程式を用いて、物理系の運動を記述することである。そのために、作用の変分が0になる条件が$\vec F - m\ddot{\vec r}=0$となるような作用を考える。ここで、運動エネルギーについては、
$$
δ\int _{t_i}^{t_f}\frac{1}{2}m\dot{\vec r}^2 dt = \int _{t_i}^{t_f}m\ddot{\vec r} \cdot δ{\vec r} dt
$$</p>
<p>であり、位置エネルギーについては、
$$
δ\int _{t_i}^{t_f}U(\vec r) dt = \int _{t_i}^{t_f}\vec F \cdot δ{\vec r} dt
$$</p>
<p>である。よって、
$$
δ\int _{t_i}^{t_f}(\frac{1}{2}m\dot{\vec r}^2-U(\vec r)) dt = \int _{t_i}^{t_f}(m\ddot{\vec r} - \vec F) \cdot δ{\vec r} dt
$$</p>
<p>となるため、変分が0になる条件は$δ{\vec r}$は任意であるため、
$$
m\ddot{\vec r} - \vec F = 0
$$</p>
<p>よって、作用は
$$
S = \int _{t_i}^{t_f}(V-U) dt
$$</p>
<p>とすればよく、これをラグランジアン$L=V-U$という。なお、変分が0になる条件は、オイラー・ラグランジュ方程式より
$$
\frac{\partial L}{\partial x_i} - \frac{d}{dt}\frac{\partial L}{\partial \dot{x_i}} = 0
$$
となる。</p>
<h2 id="%E3%83%A9%E3%82%B0%E3%83%A9%E3%83%B3%E3%82%B8%E3%82%A2%E3%83%B3%E3%81%AE%E5%B0%8E%E5%87%BAver-1">ラグランジアンの導出(ver 1)</h2>
<p>ここで、ラグランジアンを導出してみよう。まず、<strong>デカルト座標</strong>の座標$x_1,x_2,\cdots ,x_n$と一般化座標$q_1,q_2,\cdots ,q_n$を考える。それぞれの座標は
$$
\left{
\begin{array}{l}
x_1=x_1(q_1,q_2,\cdots ,q_n) \
\vdots \
x_n=x_n(q_1,q_2,\cdots ,q_n)
\end{array}
\right.
$$</p>
<p>となる。運動エネルギーはデカルト座標で表すと
$$
T(\dot x_1,\dot x_2,\cdots ,\dot x_n) = \frac{1}{2}\sum_{k=1}^{n}m_k\dot{x}_k^2
$$</p>
<p>となる。ここで、全微分$dT$は
$$
dT = \sum_{k=1}^{n}\frac{\partial T}{\partial \dot x_k}d\dot x_k
$$</p>
<p>なので、偏微分$\frac{\partial T}{\partial \dot q_i}$は
$$
\frac{\partial T}{\partial \dot q_i} = \sum_{k=1}^{n}\frac{\partial T}{\partial \dot x_k}\cdot\frac{\partial \dot x_k}{\partial \dot q_i}
$$<br>
となる。</p>
<p>一方、一般化運動量$p_i(=\frac{\partial L}{\partial \dot{q}<em>i})=\frac{\partial T}{\partial \dot{q}<em>i}$はそのまま代入すれば、
$$
p_i=\frac{\partial T}{\partial \dot q_i} = \sum</em>{k=1}^{n}\frac{\partial T}{\partial \dot x_k}\cdot\frac{\partial \dot x_k}{\partial \dot q_i} = \sum</em>{k=1}^{n}m_i\dot x_k\cdot\frac{\partial \dot x_k}{\partial \dot q_i}
$$
となる。さらに$\frac{\partial \dot x_i}{\partial \dot q_i}=\frac{\partial x_i}{\partial q_i}$なので、
$$
p_i=\sum_{k=1}^{n}m_k\dot x_k\cdot\frac{\partial x_k}{\partial q_i}
$$
となる。よって$\dot p_i$は
$$
\dot p_i = \sum_{k=1}^{n}m_k\ddot x_k\cdot\frac{\partial x_k}{\partial q_i} + \sum_{k=1}^{n}m_k\dot x_k\cdot\frac{\partial \dot x_k}{\partial q_i}
$$</p>
<p>となる。$m_i\ddot x_i=F_i$であり、$\sum_{k=1}^{n}m_i\dot x_i\cdot\frac{\partial \dot x_i}{\partial q_k}=\frac{\partial T}{\partial q_i}$なので、
$$
\dot p_i = \sum_{k=1}^{n}F_i\cdot\frac{\partial x_i}{\partial q_k} + \frac{\partial T}{\partial q_i}
$$</p>
<p>ここで、質点系全体にした微小仕事$dW$は
$$
dW = \sum_{k=1}^{n}F_k\cdot d\bold{x}<em>k
$$
なので、微小変位$d\bold{x}<em>k$を全微分と見てこれを一般座標で変形すれば
$$
dW = \sum</em>{k=1}^{n}F_k(\sum</em>{l=1}^{n}\frac{\partial x_k}{\partial q_l}dq_l)
$$
となる。$\sum$を入れ替えて
$$
dW = \sum_{l=1}^{n}(\sum_{k=1}^{n}F_k\cdot\frac{\partial x_k}{\partial q_l})dq_l
$$
となる。よって、$\sum_{k=1}^{n}F_k\cdot\frac{\partial x_k}{\partial q_l}$を一般化力$Q_l$と呼ぶ。これを$\dot p_i$の式に代入すると
$$
\dot p_i = Q_i + \frac{\partial T}{\partial q_i}
$$</p>
<p>ここで、$F_i$を保存力とすると、$F_i=-\frac{\partial U}{\partial x_i}$となる。また、$U=U(x_1,x_2,\cdots ,x_n)$なので、
$$
dU = \sum_{k=1}^{n}\frac{\partial U}{\partial x_k}dx_k
$$
なので、
$$
\frac{\partial U}{\partial q_i} = \sum_{k=1}^{n}\frac{\partial U}{\partial x_k}\cdot\frac{\partial x_k}{\partial q_i} = -\sum_{k=1}^{n}F_k\cdot\frac{\partial x_k}{\partial q_i}=-Q_i
$$</p>
<p>より、$Q_i=-\frac{\partial U}{\partial q_i}$となる。これを$\dot p_i$の式に代入すると
$$
\dot p_i = -\frac{\partial U}{\partial q_i} + \frac{\partial T}{\partial q_i}= \frac{\partial (T-U)}{\partial q_i}
$$
より、$\dot p_i = \frac{\partial L}{\partial q_i}$となる。これに$p_i=\frac{\partial T}{\partial \dot{q}_i}=\frac{\partial L}{\partial \dot{q}_i}$を代入すると
$$
\frac{d}{dt}(\frac{\partial L}{\partial \dot{q}_i}) = \frac{\partial L}{\partial q_i}
$$
以上より、ラグランジュ方程式が成り立つことが確認できた。</p>
<h2 id="%E9%9D%9E%E4%BF%9D%E5%AD%98%E5%8A%9B%E3%81%8C%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88">非保存力がある場合</h2>
<p>非保存力がある場合、$Q_i=-\frac{\partial U}{\partial x_i}$とならないため、以下のように書き換える。
$$
Q_i=-\frac{\partial U}{\partial x_i} + Q_i'
$$</p>
<p>これを改めて$\dot p_i=Q_i+\frac{\partial T}{\partial q_i}$に代入すると
$$
\frac{d}{dt}(\frac{\partial L}{\partial \dot{q}_i}) - \frac{\partial L}{\partial q_i} = Q_i'
$$</p>
<p>となる。</p>
<h2 id="%E3%83%A9%E3%82%B0%E3%83%A9%E3%82%B8%E3%82%A2%E3%83%B3%E3%81%AE%E4%B8%8D%E5%AE%9A%E6%80%A7">ラグラジアンの不定性</h2>
<p>$W=W(\lbrace q \rbrace)$とする。この時、ラグラジアン$L'$を以下のように定義する。
$$
L'=L+\frac{dW}{dt}
$$
この時、ラグラジアン$L$と$L'$は同じラグラジアン方程式を満たす。関数$W$は母関数と呼ばれる。</p>
<h2 id="%E5%BA%A7%E6%A8%99%E5%A4%89%E6%8F%9B">座標変換</h2>
<p>ラグランジュ方程式は、一般化座標$q_i$を別の一般化座標$Q_i$を用いて、$q_i=q_i(\lbrace Q \rbrace,t)$と表すことができる。その際のラグラジアンは別の一般化座標$Q_i$とその微分$\dot Q_i$を用いて、$L'=L'(\lbrace Q \rbrace,\lbrace \dot Q \rbrace,t)$と表すことができる。ただし、$L'$とはラグラジアン$L$を一般化座標$q_i$から$Q_i$に変換したものである。</p>
<p>一方、正準方程式の場合は正準変数$q_i$及び$p_i$を他の正準変数$Q_i$及び$P_i$用いて、$q_i=q_i(\lbrace Q \rbrace,\lbrace P \rbrace,t)$及び$p_i=p_i(\lbrace Q \rbrace,\lbrace P \rbrace,t)$と表すことができる。
その際のハミルトニアンは別の正準変数$Q_i$及び$P_i$を用いて、$H'=H'(\lbrace Q \rbrace,\lbrace P \rbrace,t)$と表すことができる。ただし、$H'$とはハミルトニアン$H$を正準変数$q_i$及び$p_i$から$Q_i$及び$P_i$に変換したものである。</p>
<p>ここで、正準変数の変換(正準変換)は一般化座標と一般化運動量が混ざった変換が可能なため、次元的にもはや変換後は一般化座標と一般化運動量と呼べないケースが出てくる。よって正準変数と呼んでいる。</p>
<h2 id="%E3%83%AB%E3%82%B8%E3%83%A3%E3%83%B3%E3%83%89%E3%83%AB%E5%A4%89%E6%8F%9B">ルジャンドル変換</h2>
<p>$f$個の独立変数$u_i(i=1,2,\cdots ,f)$からなる多変数関数$F(u_1,u_2,\cdots ,u_f)$を考える。これを$u_i$で偏微分したものを
$$
v_i = \frac{\partial F}{\partial u_i}
$$
とおく。ここで$v_i$からなる多変数関数$G(v_1,v_2,\cdots ,v_f)$を考える。これを$v_i$で偏微分したものを
$$
u_i = \frac{\partial G}{\partial v_i}
$$
とおく。これらの全微分は
$$
δF = \sum_{i=1}^{f}\frac{\partial F}{\partial u_i}δu_i = \sum_{i=1}^{f}v_iδu_i
$$
$$
δG = \sum_{i=1}^{f}\frac{\partial G}{\partial v_i}δv_i = \sum_{i=1}^{f}u_iδv_i
$$
となるのでこれらを足して
$$
δF + δG = \sum_{i=1}^{f}(v_iδu_i + u_iδv_i)
$$
となる。ここで$δ(u_iv_i)=u_iδv_i + v_iδu_i$なので
$$
δ(F+G) = δ\sum_{i=1}^{f}u_iv_i
$$
よって、
$$
F+G = \sum_{i=1}^{f}u_iv_i
$$
となる。式変形して
$$
G = \sum_{i=1}^{f}u_iv_i - F
$$</p>
<p>となる。</p>
<p>これを拡張してさらに共通の$f$個の変数$w_i$も用いて、多変数関数$F(u_1,u_2,\cdots ,u_f,w_1,w_2,\cdots ,w_f)$を考える。これを$u_i$で偏微分したものを
$$
v_i = \frac{\partial F}{\partial u_i}
$$
とおく。さらに多変数関数$G(v_1,v_2,\cdots ,v_f,w_1,w_2,\cdots ,w_f)$を考える。これを$v_i$で偏微分したものを
$$
w_i = \frac{\partial G}{\partial v_i}
$$
とおく。これらの全微分の合計は
$$
\begin{align*}
δ(F+G) &amp;= \sum_{i=1}^{f}(v_iδu_i + u_iδv_i) + \sum_{i=1}^{f}(\frac{\partial F}{\partial w_i}+\frac{\partial G}{\partial w_i})δw_i\
&amp;=δ\sum_{i=1}^{f}u_iv_i + \sum_{i=1}^{f}(\frac{\partial F}{\partial w_i}+\frac{\partial G}{\partial w_i})δw_i
\end{align*}
$$</p>
<p>となる。ここで上式は恒等的に成り立つので、
$$
\frac{\partial F}{\partial w_i}=-\frac{\partial G}{\partial w_i}
$$
かつ
$$
F = \sum_{i=1}^{f}u_iv_i - G
$$
となる。この関係式をルジャンドル変換という。</p>
<p>ルジャンドル変換は、例えば$F(u_1,u_2,\cdots ,u_f,w_1,w_2,\cdots ,w_f)$の関数系と$\lbrace u \rbrace,\lbrace w \rbrace$の値を決めたとする。すると関数$G(v_1,v_2,\cdots ,v_f,w_1,w_2,\cdots ,w_f)$の関数系及び$\lbrace v \rbrace$の値は一意に決まる。よって、ルジャンドル変換は情報を落とさない変換である。</p>
<h2 id="%E6%AD%A3%E6%BA%96%E6%96%B9%E7%A8%8B%E5%BC%8F">正準方程式</h2>
<p>正準方程式と先ほどのラグランジュ方程式の関係は以下のようになっている。
$$
\begin{align*}
&amp;F(\lbrace u \rbrace,\lbrace w \rbrace) \Leftrightarrow L(\lbrace q \rbrace,\lbrace \dot q \rbrace,) \
&amp;G(\lbrace v \rbrace,\lbrace w \rbrace) \Leftrightarrow H(\lbrace q \rbrace,\lbrace p \rbrace)\
&amp;v_i=\frac{\partial F}{\partial u_i} \Leftrightarrow p_i=\frac{\partial L}{\partial \dot q_i} \
&amp;u_i=\frac{\partial G}{\partial v_i} \Leftrightarrow \dot q_i=\frac{\partial H}{\partial p_i} \
&amp;G = \sum_{i=1}^{f}u_iv_i - F \Leftrightarrow H = \sum_{i=1}^{f}p_i\dot q_i - L\
&amp;\frac{\partial F}{\partial w_i}=-\frac{\partial G}{\partial w_i} \Leftrightarrow \frac{\partial L}{\partial q_i}=-\frac{\partial H}{\partial q_i}
\end{align*}
$$</p>
<p>となる。正準方程式は2つの式であるがまだ1つの式しか出ていない。もう1つの式は、ラグランジュの運動方程式から導かれる。ラグランジュの運動方程式より
$$
\frac{d}{dt}(\frac{\partial L}{\partial \dot q_i}) = \frac{\partial L}{\partial q_i}
$$
となる。先ほどの対応関係より
$$
p_i = \frac{\partial L}{\partial \dot q_i}
$$
なので代入して、さらに$\frac{\partial L}{\partial q_i}=-\frac{\partial H}{\partial q_i}$を適用すると
$$
\frac{dp_i}{dt} = \frac{\partial L}{\partial q_i}= -\frac{\partial H}{\partial q_i}
$$
となる。以上より
$$
\begin{align*}
&amp;\frac{dq_i}{dt}=\frac{\partial H}{\partial p_i} \
&amp;\frac{dp_i}{dt}=-\frac{\partial H}{\partial q_i}
\end{align*}
$$
となる。</p>
<h2 id="%E4%BD%8D%E7%9B%B8%E7%A9%BA%E9%96%93%E3%81%A8%E3%83%88%E3%83%A9%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%83%AA%E3%83%BC">位相空間とトラジェクトリー</h2>
<p>正準方程式では、$2f$個の変数$\lbrace q \rbrace,\lbrace p \rbrace$がハミルトニアンによって決定される。よって$2f$次元の空間を考えると、運動の各状態はこの空間の点で表される。この空間を位相空間という。また、この空間の点の軌跡をトラジェクトリーという。</p>
<h2 id="%E3%83%8F%E3%83%9F%E3%83%AB%E3%83%88%E3%83%8B%E3%82%A2%E3%83%B3%E3%81%AE%E6%99%82%E5%88%BB%E3%81%AB%E3%82%88%E3%82%8B%E5%A4%89%E5%8C%96">ハミルトニアンの時刻による変化</h2>
<p>ハミルトニアン$H=H(\lbrace q \rbrace,\lbrace p \rbrace,t)$を時刻で微分すると
$$
\frac{dH}{dt} = \sum_{i=1}^{f}(\frac{\partial H}{\partial q_i}\dot q_i + \frac{\partial H}{\partial p_i}\dot p_i) + \frac{\partial H}{\partial t}
$$
となるが、正準方程式より結局
$$
\frac{dH}{dt} = \frac{\partial H}{\partial t}
$$
となる。よってハミルトニアンが陽に時刻に依存しない場合は、ハミルトニアンは保存する。</p>
<h2 id="%E6%AD%A3%E6%BA%96%E5%A4%89%E6%8F%9B">正準変換</h2>
<p>正準変換とは、正準方程式を満たすような変換のことである。以下のような場合を考える。</p>
<p>$$
\int_{t_1}^{t_2}L(\lbrace q \rbrace,\lbrace \dot q \rbrace,t)dt = \int_{t_1}^{t_2}(L'(\lbrace Q \rbrace,\lbrace \dot Q \rbrace,t)+\frac{dW}{dt})dt
$$
なお、
$$
\begin{align*}
&amp;L(\lbrace q \rbrace,\lbrace \dot q \rbrace,t) = \sum_{i=1}^{f}p_i\dot q_i - H(\lbrace q \rbrace,\lbrace p \rbrace,t) \
&amp;L'(\lbrace Q \rbrace,\lbrace \dot Q \rbrace,t) = \sum_{i=1}^{f}P_i\dot Q_i - K(\lbrace Q \rbrace,\lbrace P \rbrace,t)
\end{align*}
$$
である。ここでの目標は、$\lbrace q \rbrace,\lbrace p \rbrace$から$\lbrace Q \rbrace,\lbrace P \rbrace$の関係を求めることである。とりあえず代入して
$$
\int_{t_1}^{t_2}(\sum_{i=1}^{f}p_i\dot q_i - H(\lbrace q \rbrace,\lbrace p \rbrace,t))dt = \int_{t_1}^{t_2}(\sum_{i=1}^{f}P_i\dot Q_i - K(\lbrace Q \rbrace,\lbrace P \rbrace,t)+\frac{dW}{dt})dt
$$
である。よって
$$
\sum_{i=1}^{f}p_i\dot q_i - H(\lbrace q \rbrace,\lbrace p \rbrace,t) = \sum_{i=1}^{f}P_i\dot Q_i - K(\lbrace Q \rbrace,\lbrace P \rbrace,t)+\frac{dW}{dt}
$$
である。</p>
<p>$W=W(\lbrace q \rbrace,\lbrace Q \rbrace,t)$の場合、$\frac{dw}{dt}$は
$$
\frac{dw}{dt} = \sum_{i=1}^{f}(\frac{\partial W}{\partial q_i}\dot q_i + \frac{\partial W}{\partial Q_i}\dot Q_i) + \frac{\partial W}{\partial t}
$$
となるため代入して
$$
\sum_{i=1}^{f}p_i\dot q_i - H = \sum_{i=1}^{f}P_i\dot Q_i - K+\sum_{i=1}^{f}(\frac{\partial W}{\partial q_i}\dot q_i + \frac{\partial W}{\partial Q_i}\dot Q_i) + \frac{\partial W}{\partial t}
$$
なるので変形して
$$
\sum_{i=1}^{f}(p_i-\frac{\partial W}{\partial q_i})\dot q_i - \sum_{i=1}^{f}(P_i-\frac{\partial W}{\partial Q_i})\dot Q_i - (H-K-\frac{\partial W}{\partial t}) = 0
$$
となる。$dt$をかけて
$$
\sum_{i=1}^{f}(p_i-\frac{\partial W}{\partial q_i})dq_i - \sum_{i=1}^{f}(P_i-\frac{\partial W}{\partial Q_i})dQ_i - (H-K-\frac{\partial W}{\partial t})dt = 0
$$
となる。$dq_i,dQ_i,dt$は任意の微小量なので、
$$
\begin{align*}
&amp;p_i = \frac{\partial W}{\partial q_i} \
&amp;P_i = \frac{\partial W}{\partial Q_i} \
&amp;H = K + \frac{\partial W}{\partial t}
\end{align*}
$$
となる。<strong>よって母関数$W$が与えられれば、正準変換は一意に決まる。また、$W$が時刻tを陽に含まない場合は、ハミルトニアンは$H=K$となるので同じハミルトニアンを変数変換したものを使えばいい。</strong></p>
<p>つまりこれは、位相空間$(\lbrace q \rbrace,\lbrace p \rbrace)$から位相空間$(\lbrace Q \rbrace,\lbrace P \rbrace)$への変換であり、ある運動があったときそれぞれの空間に対応するハミルトニアンがあり、それらは同じになる道理はどこにもないのだが、変換の種である母関数がtを陽に含まない場合は同じハミルトニアンを使えばいいということになる。</p>

</article>
</body>
<script>
	elements = document.getElementsByTagName("h2");
	table_of_contents = document.createElement("ul");
	h2=document.createElement("h2");
	h2.textContent="目次"
	table_of_contents.appendChild(h2)
	for (  var i = 0;  i < elements.length;  i++  ) {
		console.log(elements[ i ]);
		const newElement_li = document.createElement("li");
		const newElement_a = document.createElement("a");
		newElement_a.href="#"+elements[ i ].id;
		newElement_a.textContent = elements[ i ].textContent;
		newElement_li.appendChild(newElement_a);
		table_of_contents.appendChild(newElement_li);
		
	}
	parents=document.getElementsByClassName("markdown-body")[0];
	h1 = document.getElementsByTagName("h1")[0];
	parents.insertBefore(table_of_contents, h1.nextSibling)
</script>
</html>